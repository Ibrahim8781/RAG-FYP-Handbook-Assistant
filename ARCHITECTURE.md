# FYP Handbook RAG System - Architecture

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FYP HANDBOOK RAG ASSISTANT                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         INPUT PHASE                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ FYP_Handbook_2023.pdfâ”‚
    â”‚   (Source Document)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   ingest.py          â”‚
    â”‚   (Ingestion Script) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PROCESSING PIPELINE                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [1] Load PDF
         â”‚
         â†“  PyPDF2.PdfReader
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Extract Text    â”‚
    â”‚ Per Page        â”‚
    â”‚ (page_number)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
    [2] Chunk Text
         â”‚
         â†“  Word-based sliding window
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Create Chunks           â”‚
    â”‚ â€¢ Size: 300 words       â”‚
    â”‚ â€¢ Overlap: 90 words     â”‚
    â”‚ â€¢ Metadata: page, hint  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
    [3] Embed Chunks
         â”‚
         â†“  Sentence-BERT (all-MiniLM-L6-v2)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Generate Embeddings     â”‚
    â”‚ â€¢ Dimension: 384        â”‚
    â”‚ â€¢ L2 Normalized         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
    [4] Build Index
         â”‚
         â†“  FAISS IndexFlatIP
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Create Vector Index     â”‚
    â”‚ â€¢ Type: Inner Product   â”‚
    â”‚ â€¢ Similarity: Cosine    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
    [5] Persist
         â”‚
         â†“  Save to disk
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Save Files              â”‚
    â”‚ â€¢ faiss_index.bin       â”‚
    â”‚ â€¢ chunks_metadata.pkl   â”‚
    â”‚ â€¢ config.json           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      QUERY PHASE                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    app.py            â”‚         â”‚     ask.py           â”‚
    â”‚  (Streamlit UI)      â”‚         â”‚   (CLI Interface)    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚                                 â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â†“
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  User Query    â”‚
                   â”‚  "What are...?"â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         RETRIEVAL PIPELINE                            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    [1] Embed Query
         â”‚
         â†“  all-MiniLM-L6-v2
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Query â†’ 384-dim vector  â”‚
    â”‚ L2 Normalized           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
    [2] Search Index
         â”‚
         â†“  FAISS.search(top_k=5)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Cosine Similarity       â”‚
    â”‚ Return top-5 chunks     â”‚
    â”‚ + similarity scores     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
    [3] Filter
         â”‚
         â†“  Threshold = 0.25
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Check Relevance         â”‚
    â”‚ If score < 0.25:        â”‚
    â”‚   â†’ "Not in handbook"   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
    [4] Format Context
         â”‚
         â†“  Combine chunks
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Create Context String   â”‚
    â”‚ [Chunk X - Page Y]      â”‚
    â”‚ {text}                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
    [5] Generate Answer
         â”‚
         â†“  Extract + Cite
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Extract Answer          â”‚
    â”‚ Add citations: (p. X)   â”‚
    â”‚ Format sources          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    DISPLAY RESULT       â”‚
    â”‚                         â”‚
    â”‚ â€¢ Answer with citations â”‚
    â”‚ â€¢ Source chunks         â”‚
    â”‚ â€¢ Page references       â”‚
    â”‚ â€¢ Confidence score      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      DATA FLOW SUMMARY                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

PDF â†’ Text â†’ Chunks â†’ Embeddings â†’ FAISS Index
                                        â†“
User Query â†’ Query Embedding â†’ Search â†’ Top-K Chunks
                                        â†“
                              Context + Prompt â†’ Answer + Citations
                                        â†“
                                    Display
```

## Component Details

### 1. Ingestion (Offline)

```
Input:   FYP_Handbook_2023.pdf
Process: ingest.py
Output:  faiss_index.bin, chunks_metadata.pkl, config.json
Time:    ~1-2 minutes (one-time)
```

**Key Operations:**
- PyPDF2: Extract text per page
- Chunking: 300 words, 90-word overlap
- Embedding: all-MiniLM-L6-v2 (384-dim)
- Indexing: FAISS IndexFlatIP
- Storage: Binary serialization

### 2. Query (Online)

```
Input:   User question (text)
Process: ask.py or app.py
Output:  Answer with page citations
Time:    <1 second
```

**Key Operations:**
- Encode query: Sentence-BERT
- Search: FAISS cosine similarity
- Filter: Threshold = 0.25
- Extract: Rule-based with citations
- Display: Formatted answer + sources

## Prompt Template Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         PROMPT CONSTRUCTION              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

System Prompt (Fixed)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
You are a handbook assistant.
Answer ONLY from the context.
Cite page numbers like "(p. X)".
If unsure, say you don't know.

         +

User Question (Variable)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"What margins and spacing do we use?"

         +

Retrieved Context (Dynamic)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[Chunk 1 - Page 16]
The report margins should be...

[Chunk 2 - Page 15]
Page setup requires...

         â†“

Complete Prompt
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[System + Question + Context]

         â†“

Answer Generation
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
(Current: Rule-based extraction)
(Future: LLM integration)

         â†“

Final Answer
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
"The report margins should be
set as follows: Top 1.5"... (p. 16)"
```

## Similarity Scoring

```
Query Embedding          Chunk Embeddings
     [384]          Ã—        [N Ã— 384]
       â”‚                         â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
                â†“
         Cosine Similarity
         â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
         score = (q Â· c) / (||q|| Ã— ||c||)
         
         (Already normalized, so just: q Â· c)
                â”‚
                â†“
         Sort by score (descending)
                â”‚
                â†“
         Take top-5
                â”‚
                â†“
         Apply threshold (0.25)
                â”‚
                â†“
         Return chunks + scores
```

## User Interface Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“š FYP Handbook Assistant                                 â”‚
â”‚  Ask questions about the FAST-NUCES FYP process            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚  Sidebar                    Main Panel                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ System Info  â”‚          â”‚ Ask a Question            â”‚   â”‚
â”‚  â”‚              â”‚          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚ â€¢ Chunks     â”‚          â”‚ â”‚ [Input Box]          â”‚  â”‚   â”‚
â”‚  â”‚ â€¢ Model      â”‚          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚ â€¢ Top-K      â”‚          â”‚ [ğŸ” Ask Button]          â”‚   â”‚
â”‚  â”‚ â€¢ Threshold  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚              â”‚                                          â”‚
â”‚  â”‚ Sample       â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Questions    â”‚          â”‚ ğŸ“ Answer                â”‚   â”‚
â”‚  â”‚              â”‚          â”‚ ğŸŸ¢ Confidence: High      â”‚   â”‚
â”‚  â”‚ 1. Fonts?    â”‚          â”‚                           â”‚   â”‚
â”‚  â”‚ 2. Margins?  â”‚          â”‚ [Answer text with         â”‚   â”‚
â”‚  â”‚ 3. Chapters? â”‚          â”‚  page citations]          â”‚   â”‚
â”‚  â”‚ ...          â”‚          â”‚                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                            â”‚ â–¼ ğŸ“š Sources             â”‚   â”‚
â”‚                            â”‚                           â”‚   â”‚
â”‚                            â”‚ â€¢ Page 16: ...            â”‚   â”‚
â”‚                            â”‚ â€¢ Page 15: ...            â”‚   â”‚
â”‚                            â”‚                           â”‚   â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                            â”‚
â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                            â”‚ â–¼ ğŸ”§ Debug Info          â”‚   â”‚
â”‚                            â”‚                           â”‚   â”‚
â”‚                            â”‚ Scores: [0.87, 0.75...]   â”‚   â”‚
â”‚                            â”‚ Prompt: ...               â”‚   â”‚
â”‚                            â”‚                           â”‚   â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## File Dependencies

```
ingest.py
    â†“ requires
    â€¢ PyPDF2
    â€¢ sentence-transformers
    â€¢ faiss
    â€¢ numpy
    â†“ reads
    â€¢ FYP_Handbook_2023.pdf
    â†“ writes
    â€¢ faiss_index.bin
    â€¢ chunks_metadata.pkl
    â€¢ config.json

ask.py / app.py
    â†“ requires
    â€¢ sentence-transformers
    â€¢ faiss
    â€¢ numpy
    â€¢ streamlit (app.py only)
    â†“ reads
    â€¢ faiss_index.bin
    â€¢ chunks_metadata.pkl
    â€¢ config.json
    â†“ outputs
    â€¢ Answer with citations
    â€¢ Source references
```

## Metadata Structure

```
Chunk Object
â”œâ”€â”€ chunk_id: int
â”œâ”€â”€ page_number: int
â”œâ”€â”€ text: str
â”œâ”€â”€ section_hint: str
â””â”€â”€ word_count: int

Example:
{
  "chunk_id": 42,
  "page_number": 16,
  "text": "The report margins should be...",
  "section_hint": "REPORT FORMATTING",
  "word_count": 287
}
```

## Configuration Flow

```
ingest.py (Creation)
    â†“
    Saves config.json:
    {
      "chunk_size": 300,
      "overlap": 90,
      "embedding_model": "all-MiniLM-L6-v2",
      "num_chunks": 247,
      "embedding_dim": 384
    }
    â†“
ask.py/app.py (Loading)
    â†“
    Reads config.json
    â†“
    Uses settings for consistency
```

---

---

## Validation Results

### Question 1: Font Requirements
**Query:** "What headings, fonts, and sizes are required in the FYP report?"

**Expected:** Times New Roman 11pt body, Arial headings (Title 16pt, H1 14pt, H2 12pt, H3 11pt)

**System Output:**
```
The FYP report should use Times New Roman 11pt for body text. (p. 15)
Headings must be in Arial with sizes: Title 16pt, H1 14pt, H2 12pt, H3 11pt. (p. 15)
```
âœ… Page citations included, accurate information

### Question 2: Margins & Spacing
**Query:** "What margins and spacing do we use?"

**Expected:** Top 1.5", Bottom 1.0", Left 2.0", Right 1.0", Line spacing 1.5, Para spacing 6pt

**System Output:**
```
Margins: Top 1.5", Bottom 1.0", Left 2.0", Right 1.0". (p. 16)
Line spacing should be 1.5 with 6pt paragraph spacing. (p. 16)
```
âœ… Complete specifications with page references

### Question 3-6: Chapter Requirements, Endnotes, Executive Summary
All validation questions return accurate answers with proper page citations (p. X), retrieved sources with relevance scores, and appropriate confidence levels.

---

## Key Design Decisions

### Why 300-word chunks with 30% overlap?
- Balances context preservation and retrieval precision
- Overlap prevents information loss at chunk boundaries
- Within required 250-400 word range

### Why threshold = 0.25?
- Prevents answering out-of-scope questions
- Reduces hallucination risk
- Empirically effective for document Q&A

### Why FAISS IndexFlatIP?
- Exact cosine similarity (no approximation)
- Fast for small-to-medium datasets
- Simple, reliable, easy to debug

### Why rule-based answer extraction?
- **Current:** Fast, no API costs, deterministic
- **Future:** Can integrate LLM (GPT-4, Claude) for better synthesis
- Grounding mechanism works with either approach

---

## Performance Characteristics

- **Indexing:** 1-2 minutes (one-time)
- **Query:** <1 second
- **Memory:** ~200-300 MB
- **Accuracy:** High for in-scope queries
- **Grounding:** 100% (all answers cite pages)
